---
import Layout from '../layouts/Layout.astro';
---

<Layout title="Bewertungen">
  <main>
    <h1>Bewertungen Abgeben</h1>
    <form id="bewertungen-form" method="post">
      <label for="bewertung-message">Deine Bewertung:</label>
      <textarea id="bewertung-message" name="bewertung-message" rows="4" required></textarea>
      <label>Bewertung:</label>
      <div class="stars">
        <input type="radio" id="star5" name="rating" value="5" />
        <label for="star5" class="star">&#9733;</label>
        <input type="radio" id="star4" name="rating" value="4" />
        <label for="star4" class="star">&#9733;</label>
        <input type="radio" id="star3" name="rating" value="3" />
        <label for="star3" class="star">&#9733;</label>
        <input type="radio" id="star2" name="rating" value="2" />
        <label for="star2" class="star">&#9733;</label>
        <input type="radio" id="star1" name="rating" value="1" />
        <label for="star1" class="star">&#9733;</label>
      </div>
      <button type="submit">Absenden</button>
    </form>
  </main>
</Layout>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const form = document.getElementById('bewertungen-form') as HTMLFormElement;

    form.addEventListener('submit', (event) => {
      event.preventDefault();

      // Type-Casting für Textarea und Input
      const message = (form.querySelector('#bewertung-message') as HTMLTextAreaElement).value;
      const rating = (form.querySelector('input[name="rating"]:checked') as HTMLInputElement).value;

      const bewertung = {
        id: Date.now(),
        type: 'Bewertung',
        message: message,
        rating: parseInt(rating),
        username: 'Anonym',
        replies: []
      };

      let messages = JSON.parse(localStorage.getItem('messages') || '[]');
      messages.push(bewertung);
      localStorage.setItem('messages', JSON.stringify(messages));
      alert('Bewertung gesendet!');
      form.reset();  // Hier ist `reset` für `HTMLFormElement` verfügbar
    });
  });
</script>

<style>
  main {
    margin: auto;
    padding: 2rem;
    width: 800px;
    max-width: calc(100% - 2rem);
    color: white;
    font-size: 22px;
    line-height: 1.6;
  }

  form {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  textarea {
    padding: 0.5rem;
    border-radius: 8px;
    border: 1px solid #555;
    background: #1e1e1e;
    color: white;
    width: 100%;
  }

  .stars {
    display: flex;
    gap: 0.5rem;
  }

  .stars input {
    display: none;
  }

  .stars label {
    font-size: 2rem;
    color: #FFD700;
    cursor: pointer;
  }

  .stars input:checked ~ label {
    color: #FFBF00;
  }

  button {
    padding: 0.75rem;
    background: var(--accent-gradient);
    color: white;
    border: none;
    border-radius: 10px;
    cursor: pointer;
    transition: background 0.3s ease, transform 0.3s ease;
  }

  button:hover {
    background: var(--accent-dark);
    transform: translateY(-2px);
  }
</style>
